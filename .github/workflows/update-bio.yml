name: ‚Äúü¶Ñ Update Bio with ETH Price‚Äù

on:
  schedule:
    # every hour at minute 0
    - cron: '0 * * * *'
  workflow_dispatch:

jobs:
  update-bio:
    runs-on: ubuntu-latest
    steps:
      - name: Fetch current ETH‚ÜíUSD price
        id: price
        run: |
          PRICE=$(curl -s 'https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd' \
            | jq -r '.ethereum.usd')
          echo "::set-output name=price::$PRICE"

            - name: Update GitHub profile bio
        run: |
          PRICE=${{ steps.price.outputs.price }}
          # Build a bio with emoji ‚Äúborders‚Äù and the live price
          NEW_BIO="üî∑ ETH Believer üî∑ | Current ETH: \$${PRICE} USD"
          echo "‚úèÔ∏è Setting new bio to: $NEW_BIO"
          curl -s -o /dev/null -w "%{http_code}" \
            -X PATCH \
            -H "Authorization: token ${{ secrets.USER_BIO_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d "$(jq -n --arg bio "$NEW_BIO" '{bio: $bio}')" \
            https://api.github.com/user

